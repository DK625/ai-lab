**Phase 6: Track Planning** là giai đoạn "điều quân khiển tướng" cuối cùng trước khi bắt đầu thực thi code. Sau khi bạn đã có các mảnh ghép công việc (Beads) được kiểm chứng ở Phase 5, Phase 6 sẽ phân chia chúng vào các **Luồng công việc (Tracks)** để nhiều Agent (công nhân AI) có thể làm việc cùng lúc mà không dẫm chân lên nhau.

Dưới đây là giải thích chi tiết 3 bước then chốt:

---

### Bước 1: Get Parallel Tracks (Xác định các luồng song song)

Mục tiêu của bước này là tìm xem những công việc nào có thể làm đồng thời để tiết kiệm thời gian.

* **Lệnh:** `bv --robot-plan` sẽ phân tích sơ đồ phụ thuộc (Dependency Graph) của các Bead.
* **Ý nghĩa:** Nếu Bead A (sửa Database) và Bead B (viết tài liệu API) không phụ thuộc vào nhau, công cụ sẽ xếp chúng vào 2 **Tracks** khác nhau. Điều này cho phép hệ thống gọi 2 Agent làm việc song song thay vì phải đợi hết việc này mới làm việc kia.

---

### Bước 2: Assign File Scopes (Phân vùng phạm vi tệp)

Đây là bước cực kỳ quan trọng để tránh **xung đột code (merge conflicts)**. Bạn phải xác định mỗi luồng công việc sẽ được phép chỉnh sửa những thư mục/file nào.

* **Quy tắc "Không chồng lấn":** Nếu Track 1 đang sửa các file trong `apps/server/**`, thì Track 2 tuyệt đối không được chạm vào đó. Nếu cả hai luồng bắt buộc phải sửa cùng một file (ví dụ cùng sửa `main.ts`), bạn phải **gộp (merge)** chúng lại thành một luồng duy nhất để làm tuần tự.
* **Sử dụng Glob Pattern:** Bạn dùng các mẫu như `packages/sdk/**` để khoanh vùng cho Agent. Điều này giống như việc chia thợ xây ra các phòng khác nhau; thợ điện làm phòng khách, thợ nước làm nhà tắm để không ai vướng chân ai.

---

### Bước 3: Generate Agent Names (Đặt tên cho Agent)

Thay vì gọi là "Agent 1", "Agent 2" rất dễ nhầm lẫn, quy trình yêu cầu đặt tên theo công thức **Tính từ + Danh từ** (ví dụ: `BlueLake`, `GreenCastle`, `RedStone`).

* **Tại sao cần tên riêng?** Khi bạn theo dõi log hoặc quản lý hàng chục Agent đang chạy, những cái tên gợi nhớ giúp bạn biết ngay "BlueLake" là nhóm đang làm về Frontend, còn "RedStone" là nhóm làm về Backend.
* **Lưu ý:** Tên này chỉ là định danh (Identifier), không phải là mô tả vai trò. Bạn không đặt tên là "Frontend-Agent" vì một luồng công việc có thể bao gồm nhiều nhiệm vụ hỗn hợp.

---

### Tổng kết luồng hoạt động

Sau khi hoàn tất Phase 6, bạn sẽ có một file `history/<feature>/execution-plan.md`. File này giống như một "bản tổng phổ" cho dàn nhạc, trong đó ghi rõ:

1. **Track BlueLake:** Làm các Bead 1, 3, 5 trong phạm vi `src/ui/**`.
2. **Track RedStone:** Làm các Bead 2, 4 trong phạm vi `src/api/**`.

**Kết quả:** Bạn có thể nhấn nút "Start" và các Agent sẽ tự động nhảy vào làm việc một cách trơn tru, an toàn và cực kỳ nhanh chóng.