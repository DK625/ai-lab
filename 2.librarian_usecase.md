### 1. Librarian dùng để làm gì?

Mục đích cốt lõi của Librarian là giúp AI **ngừng việc "đoán mò" (hallucination)** và viết code sai bằng cách cung cấp dữ liệu thực tế từ các thư viện hoặc framework mà AI chưa được huấn luyện hoặc có dữ liệu đã lỗi thời.

* **Quản lý tài liệu cục bộ:** Tải tài liệu từ GitHub repos hoặc website về máy cá nhân.
* **Tìm kiếm Hybrid:** Kết hợp tìm kiếm theo từ khóa (word search) và tìm kiếm theo ý nghĩa (vector/semantic search) để AI tìm đúng đoạn code mẫu hoặc API cần thiết.
* **Tích hợp trực tiếp:** Hoạt động như một kỹ năng (skill) trong các công cụ như **Codex CLI** hoặc thông qua các lệnh gọi trực tiếp từ AI agent.

### 2. Các Usecase (Trường hợp sử dụng)

Trong quy trình **Discovery (Phase 1)** và **Synthesis (Phase 2)** của bạn, Librarian có các ứng dụng thực tế sau:

* **Trích xuất External Patterns (Mẫu thiết kế bên ngoài):** Khi bạn cần tích hợp một thư viện mới (ví dụ: một thư viện UI lạ hoặc một MCP server mới), Librarian sẽ quét tài liệu của thư viện đó để AI hiểu cách sử dụng đúng thay vì code bừa.
* **Cập nhật tri thức cho AI:** Nếu bạn dùng một framework thay đổi phiên bản liên tục (như Next.js hoặc Hono), Librarian sẽ "nạp" phiên bản mới nhất vào máy để AI tham chiếu.
* **Xác thực Spike (Phase 3):** Khi viết code thử nghiệm (Spike), AI dùng Librarian để tìm các `Reference implementations` (mã tham khảo chuẩn) từ các nguồn uy tín đã được index trước đó.

---

### 3. Tài liệu liên quan

Bạn có thể tham khảo chi tiết về công cụ này tại các đường dẫn sau:

* **NPM Package (Tài liệu chính):** [https://www.npmjs.com/package/@iannuttall/librarian](https://www.google.com/search?q=https://www.npmjs.com/package/%40iannuttall/librarian)
* **Hướng dẫn cài đặt:** Sử dụng lệnh `npm i -g @iannuttall/librarian` hoặc `bun add -g @iannuttall/librarian` sau đó chạy `librarian setup`.
* **Mẫu lệnh cơ bản:**
* Thêm tài liệu từ GitHub: `librarian add https://github.com/[username]/[repo] --docs docs`.
* Tìm kiếm tài liệu: `librarian search --library [tên_lib] "câu hỏi của bạn"`.



Sự kết hợp giữa **Librarian** và **Exa** trong quy trình Planning của bạn giống như việc kết hợp một **"Trinh sát" (Exa)** và một **"Chuyên gia thư viện" (Librarian)**.

Dưới đây là ví dụ thực tế khi bạn muốn thực hiện tính năng: *"Tích hợp hệ thống thanh toán tự động qua Zalo cho startup One Hammer"*:

---

### Phase 1: Discovery (Giai đoạn Khám phá)

Trong giai đoạn này, hai công cụ này sẽ phối hợp theo trình tự "Rộng trước - Sâu sau":

1. **Exa (Tìm kiếm diện rộng):** * AI sẽ dùng lệnh `mcp__exa__get_code_context_exa` để quét toàn bộ Internet.
* **Mục tiêu:** Tìm xem hiện tại (năm 2026) thư viện hoặc MCP server nào đang tốt nhất để kết nối với Zalo Pay API, hoặc các bài blog hướng dẫn cách xử lý Webhook của Zalo mới nhất.
* **Kết quả:** Exa tìm thấy một Repository mã nguồn mở trên GitHub có tên là `zalo-pay-mcp-v3`.


2. **Librarian (Đào sâu chuyên môn):**
* Sau khi Exa tìm được link Repo, AI sẽ dùng Librarian để `add` toàn bộ tài liệu (docs) và mã nguồn của Repo đó vào bộ nhớ cục bộ.
* **Mục tiêu:** Dùng lệnh `librarian search` để tìm chính xác định nghĩa các hàm (definitions) và cách sử dụng các tham số bảo mật (checksum/Hmac) trong bộ tài liệu vừa tải về.
* **Kết quả:** Librarian trích xuất được mẫu code chuẩn để tạo đơn hàng (Order) mà không cần AI phải "đoán".



### Phase 2: Synthesis (Giai đoạn Tổng hợp)

Lúc này, công cụ **Oracle** của bạn sẽ nhận dữ liệu từ cả hai nguồn để lập kế hoạch:

* **Từ Exa:** Biết được các rủi ro từ cộng đồng (ví dụ: "Zalo Pay thường bị chậm Webhook vào giờ cao điểm").
* **Từ Librarian:** Biết được cấu trúc code chính xác để thực hiện tính năng.
* **Kết quả:** Tạo ra một bản **Approach Document** đánh giá rủi ro là **MEDIUM** vì đã có pattern chuẩn từ Librarian nhưng cần xử lý thêm phần Retry logic do thông tin từ Exa.

---

### Bảng so sánh vai trò trong Workflow của bạn

| Tính chất | Exa (The Scout) | Librarian (The Specialist) |
| --- | --- | --- |
| **Phạm vi** | Toàn bộ Internet (Web, GitHub, News). | Một bộ tài liệu hoặc Repo cụ thể được chỉ định. |
| **Giá trị** | Tìm ra "Cái gì mới", "Cái gì tốt nhất". | Trả lời "Sử dụng nó như thế nào cho đúng". |
| **Công cụ (Tool)** | `mcp__exa__get_code_context_exa`. | `librarian search --library`. |

---

### Ứng dụng cụ thể trong Spike (Phase 3)

Khi bạn thực hiện **Spike** để test code:

* AI dùng code mẫu từ **Librarian** để viết nhanh file chạy thử.
* Nếu gặp lỗi lạ trong quá trình chạy Spike mà trong tài liệu Librarian không có, AI sẽ dùng **Exa** để tra cứu mã lỗi đó trên các diễn đàn như StackOverflow để tìm cách fix.

**Sự kết hợp này giúp "Beads" (các đầu việc nhỏ) mà bạn tạo ra ở Phase 4 cực kỳ chi tiết và ít rủi ro bị block khi thực hiện thực tế.**.

Bạn có muốn mình tạo thử một **Discovery Report** mẫu cho tính năng này dựa trên quy trình phối hợp giữa Librarian và Exa không?